---
title: 'ALPS λ‚΄λ¶€λ€ν Bλ² - μ—°μ• κ³ μ μµμ©μ± ν’€μ΄'
categories:
    - ALPS
last_modified_at: 2020-01-31T13:00:00+09:00
toc: true
path: '/ALPS/2020-01-contest-B-solution'
---

# <center>μ—°μ• κ³ μ μµμ©μ±<center>

> ALPS 2020 1μ›” λ‚΄λ¶€λ€ν Bλ²<br>μ¶μ μ: ALPS μµμ©μ±<br>2020. 01. 31

## μ„λΈ νƒμ¤ν¬

---

|       Index        |         Constraints         |    Time Complexity     |
| :----------------: | :-------------------------: | :--------------------: |
| TC #1 (15 points)  | $k = 0$, $2 \le N \le 10^4$ |         $O(N)$         |
| TC #2 (45 points)  |     $2 \le N \le 10^4$      |        $O(N^2)$        |
| TC #3 (140 points) |        $\text{none}$        | $O(N\log_{2} p_{max})$ |

## ν’€μ΄

---

-   DP μ ν™”μ‹

$\text{DP}[i] = \max_{j \gt i+k}^{n}\begin{cases}\text{DP}[j], & \text{if }p_i \ge p_j \\\ \text{DP}[j] + p_j -p_i, & \text{otherwise}\end{cases}$

| Index | Solution                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| TC #1 | λ¨λ“  λ―Έν…μ— μ°Έμ„ν•λ” κ²ƒμ΄ ν•­μƒ μ΄λ“μ…λ‹λ‹¤.<br>λ”°λΌμ„ λ‹¤μ λ―Έν…κ³Όμ μ°¨μ΄λ¥Ό κ³„μ†ν•΄μ„ λ„μ ν•©μ„ μ·¨ν•λ©΄ ν•΄κ²°ν•  μ μμµλ‹λ‹¤.                                                                                                                                                                                                                                                                                                                                       |
| TC #2 | DP μ ν™”μ‹μ„ 2μ¤‘ forλ¬Έμ„ μ΄μ©ν•΄ κµ¬ν„ν•¨μΌλ΅μ¨ ν•΄κ²°ν•  μ μμµλ‹λ‹¤.                                                                                                                                                                                                                                                                                                                                                                                              |
| TC #3 | μ„Έκ·Έλ¨ΌνΈ νΈλ¦¬ 2κ°μ™€ ν 1κ°λ¥Ό μ΄μ©ν•΄ κµ¬ν„ν•  μ μμµλ‹λ‹¤.<br>μ„Έκ·Έλ¨ΌνΈ νΈλ¦¬μ λ¦¬ν”„ λ…Έλ“μ—λ” κ°€λ¥ν• λ¨λ“  μ μλ“¤μ„ μΈλ±μ¤λ΅ ν•λ” DPκ°’μ΄ λ“¤μ–΄μμµλ‹λ‹¤.<br>μ²«λ²μ§Έ μ„Έκ·ΈνΈλ¦¬λ” DPκ°’λ§μ„ μ €μ¥ν•©λ‹λ‹¤. μ΄λ” μ ν™”μ‹μ μ²« λ²μ§Έ μ΅°κ±΄μ— ν•΄λ‹Ήν•  λ• μ‚¬μ©ν•©λ‹λ‹¤.<br>λ‘λ²μ§Έ μ„Έκ·ΈνΈλ¦¬λ” DPκ°’μ— μκΈ° μμ‹ μ λ†’μ΄λ¥Ό λ”ν• κ°’μ„ μ €μ¥ν•©λ‹λ‹¤. μ΄λ” λ‘ λ²μ§Έ μ΅°κ±΄μ— ν•΄λ‹Ήν•©λ‹λ‹¤.<br>1κ°μ νλ” $k$λ²μ μ¶”ν›„ μ—°μ‚°μ΄ μ§€λ‚ λ’¤ μ„Έκ·Έλ¨ΌνΈ νΈλ¦¬ κ°±μ‹ μ„ ν•κΈ° μ„ν•΄ κ°’μ„ μ €μ¥ν•λ” μ©λ„λ΅ μ‚¬μ©λ©λ‹λ‹¤. |

## μ •ν•΄ μ½”λ“

---

-   ### TC #1

```c++
#include <cstdio>

using namespace std;

int N, k, res, tmp = 1e6;

int main(){
    scanf("%d %d", &N, &k);

    for (int i = 0; i < N; i++){
        int input;
        scanf("%d", &input);

        if(input > tmp)
            res += input - tmp;

        tmp = input;
    }

    printf("%d", res);

    return 0;
}
```

$k = 0$μΈ κ²½μ°, λ¨λ“  λ―Έν…μ„ μ°Έμ„ν•λ©΄ λ©λ‹λ‹¤.

λ°”λ΅ λ‹¤μ λ―Έν…μ΄ μ΄μ „ λ―Έν…λ³΄λ‹¤ μ μκ°€ λ†’μΌλ©΄ μ μ μ°¨κ°€ λ°μƒν•κΈ° λ•λ¬Έμ— μ΄λ“μ΄κ³ , μ΄μ „ λ―Έν…λ³΄λ‹¤ μ μκ°€ λ‚®μΌλ©΄ μ΄ν›„μ μ μ μ°¨λ¥Ό κΈ°λ€ν•  μ μμΌλ©° λ¦¬μ¤ν¬κ°€ μ—†κΈ° λ•λ¬Έμ— ν•­μƒ λ‹¤μ λ―Έν…μ„ μ°Έμ„ν•λ©΄ λλ‹¤λ” κ²ƒμ„ μ• μ μμµλ‹λ‹¤.

λ”°λΌμ„ λ―Έν… μ μμ— λ€ν• μ…λ ¥μ„ λ°›μΌλ©΄μ„ μ΄μ „ λ―Έν…κ³Ό μ μ μ°¨κ°€ λ°μƒν•  μ μμΌλ©΄ κ·Έ μ°¨μ΄λ¥Ό λ„μ ν•¨μΌλ΅μ¨ ν•΄κ²°ν•  μ μμµλ‹λ‹¤. μ²« λ²μ§Έ λ―Έν…μ„ μ–΄λ–»κ² μ²λ¦¬ν•΄μ•Ό ν•λ”μ§€μ— κ΄€ν• μ§λ¬Έμ΄ λ“¤μ–΄μ™”μ—μ§€λ§, λ¬Έμ  μ†μ— _μ΄μ „μ— μ°Έμ„ν•_ λ―Έν…μ΄λΌκ³  λ…μ‹λμ–΄ μμ–΄ λ”°λ΅ λ…μ‹λ¥Ό ν•μ§€λ” μ•μ•μµλ‹λ‹¤. μ΄ κ²½μ°μ μ‹κ°„λ³µμ΅λ„λ” $O(N)$μ…λ‹λ‹¤.

---

-   ### TC #2

```c++
#include <cstdio>
#include <algorithm>

using namespace std;

int arr[(int)1e7], dp[(int)1e7], k, N, maxx = -1;

int main(){
    scanf("%d %d", &N, &k);

    for (int i = 0; i < N; i++){
        scanf("%d", &arr[i]);
    }

    for (int i = 0; i < N; i++){
        for (int j = i + k + 1; j < N; j++){
            if(arr[j] > arr[i]){
                dp[j] = max(dp[j], dp[i] + arr[j] - arr[i]);
                maxx = max(maxx, dp[j]);
            }
            else{
                dp[j] = max(dp[i], dp[j]);
            }
        }
    }

    printf("%d", maxx);
}

```

Bottom-up λ°©μ‹μΌλ΅ DP μ ν™”μ‹μ„ κµ¬ν„ν• μ½”λ“μ…λ‹λ‹¤. μ•„μ΄λ””μ–΄λ” $i$λ²μ§Έ λ―Έν…μ„ λ‚κ°”λ‹¤κ³  κ°€μ •ν–μ„ λ•, $k$λ² μ΄ν›„μ $j$λ² λ―Έν…μ„ λ‹¤μμ— μ°Έμ„ν•λ‹¤κ³  ν•λ” κ²½μ° μ–»μ„ μ μλ” μ μλ¥Ό DP λ°°μ—΄μ— κΈ°λ΅ν•λ” κ²ƒμ…λ‹λ‹¤. λ”°λΌμ„ DP λ°°μ—΄μ—λ” ν•΄λ‹Ή λ―Έν…μ„ μ°Έμ„ν• λ―Έν… μ¤‘ λ§μ§€λ§‰ λ―Έν…μ΄λΌκ³  μƒκ°ν–μ„ λ• μ–»μ„ μ μλ” μµκ³ μ μ μκ°€ κΈ°λ΅λ©λ‹λ‹¤. DP λ°°μ—΄ μ¤‘ κ°€μ¥ λ†’μ€ μ μλ¥Ό μ¶λ ¥ν•¨μΌλ΅μ¨ λ¬Έμ λ¥Ό ν•΄κ²°ν•  μ μμµλ‹λ‹¤. μ΄ κ²½μ°μ μ‹κ°„λ³µμ΅λ„λ” $O(N^2)$μ…λ‹λ‹¤.

ν•΄λ‹Ή μ½”λ“λ¥Ό λ³΄λ©΄ $j$μ ν•κ³„λ¥Ό $N$κΉμ§€λ΅ μ΅μ•„λ‘μ—μ§€λ§, μ‚¬μ‹¤μ€ $i + 2*k + 1$κΉμ§€λ§ λ΄λ„ λ©λ‹λ‹¤. μ•„μ΄λ””μ–΄λ” TC #1μ—μ„ μ• μ μλ“―μ΄, μ–΄λ–¤ λ―Έν…μ„ λ‚κ°€λ” κ²ƒμ— λ€ν•΄ λ¦¬μ¤ν¬κ°€ μ—†λ‹¤λ” κ²ƒμ—μ„λ¶€ν„° λ‚μµλ‹λ‹¤.

μ΄μ „μ— μ°Έμ„ν• λ―Έν… $i$, ($k$ λ²μ λ―Έν…λ“¤), μ–΄λ–¤ λ―Έν… $p$, ($k$ λ²μ λ―Έν…λ“¤), κ°€κ³ μ ν•λ” λ―Έν… $j$κ°€ μλ‹¤κ³  ν•΄λ΄…μ‹λ‹¤.<br>κ·Έλ¬λ©΄ μ²« ($k$ λ²μ λ―Έν…λ“¤) μ¤‘μ—μ„λ” μ–΄λ–¤ κ²ƒλ„ κ° μ μ—†μµλ‹λ‹¤. μ©μ±μ΄λ” μ‰¬μ–΄μ•Ό ν•λ‹κΉμ”.<br>λ§μ•½ $j$ λ―Έν…μ— μ°Έμ„ν•κ³ μ ν–μ„ λ•, λ―Έν… $p$λ¥Ό κ°€μ§€ μ•μ„ μ΄μ κ°€ μ—†μµλ‹λ‹¤. $p$ λ―Έν…μ„ κ°€λ”λΌλ„ $j$λ¥Ό κ° μ μκ³ , $p \le j$λ©΄ μ μκ°€ μ΄λ“μ΄κ³  μ•„λ‹λ”λΌλ„ λ¦¬μ¤ν¬κ°€ μ—†κΈ° λ•λ¬Έμ— μ©μ±μ΄λ” λ―Έν… $p$λ¥Ό μ°Έμ„ν•  κ²ƒμ…λ‹λ‹¤. λ”°λΌμ„, $N$κΉμ§€ λ ν•„μ” μ—†μ΄ μ•κ³ λ¦¬μ¦μ„ μµμ ν™” ν•  μ μμµλ‹λ‹¤.<br>ν•μ§€λ§, μ΄λ” $k$κ°€ $N$λ³΄λ‹¤ μ μ€ κ²½μ°μ— ν•ν•΄ μ–΄λμ •λ„ μ‹κ°„ λ‹¨μ¶•μ΄ κ°€λ¥ν•μ§€ μ λ‹Ήν ν° κ²½μ°μ—λ” μ‹κ°„ μ°¨μ΄λ¥Ό λ³΄μ΄μ§€ μ•μµλ‹λ‹¤.

---

-   ### TC #3

```c++
#include <cstdio>
#include <algorithm>
#include <queue>

using namespace std;

const int SIZE = 1 << 15;
const int MAX = 1e4;
int arr[(int)1e7+10], k, N, maxx = -1;

struct SegTree
{
    int tree[SIZE];
    queue<pair<int, int> > q;

    SegTree()
    {
        fill(tree, tree + SIZE, 0);
    }

    int sum(int node, int l, int r, int a, int b)
    {
        if (r < a || b < l)
        {
            return 0;
        }
        if (a <= l && r <= b)
        {
            return tree[node];
        }
        return max(sum(node * 2, l, (l + r) / 2, a, b), sum(node * 2 + 1, (l + r) / 2 + 1, r, a, b));
    }

    void qupdate(int idx, int value)
    {
        q.push(make_pair(idx, value));
        if (q.size() == k + 1)
        {
            pair<int, int> tmp = q.front();
            update(1, 1, MAX, tmp.first, tmp.second);
            q.pop();
        }
    }

    int update(int node, int l, int r, int idx, int value)
    {
        if (idx < l || r < idx)
        {
            return tree[node];
        }
        if (l == r)
        {
            return tree[node] = value;
        }
        return tree[node] = max(update(node * 2, l, (l + r) / 2, idx, value), update(node * 2 + 1, (l + r) / 2 + 1, r, idx, value));
    }
};

SegTree sg1, sg2;

int main()
{
    scanf("%d %d", &N, &k);

    for (int i = 0; i < N; i++)
    {
        scanf("%d", &arr[i]);
    }

    for (int i = N - 1; i >= 0; i--)
    {
        int current = arr[i];
        if (i > N - k - 2)
        {
            sg2.qupdate(current, current);
        }
        else
        {
            int fst = sg1.sum(1, 1, MAX, 1, current);
            int snd = sg2.sum(1, 1, MAX, current + 1, MAX) - current;

            int value = max(fst, snd);
            sg1.qupdate(current, value);
            sg2.qupdate(current, value + current);

            maxx = max(maxx, value);
        }
    }

    printf("%d", maxx);

    return 0;
}
```

$N$μ΄ $10^6$κΉμ§€ μ£Όμ–΄μ΅μ„ λ• μ‹κ°„ μ ν• λ‚΄μ— λ¬Έμ λ¥Ό ν•΄κ²°ν•κΈ° μ„ν•΄μ„λ” λ‹¤λ¥Έ λ°©λ²•μ΄ λ„μ…λμ–΄μ•Ό ν•©λ‹λ‹¤.

μ κ°€ μ¬λ ¤λ“λ¦° μ½”λ“λ” μ„Έκ·Έλ¨ΌνΈ νΈλ¦¬λ¥Ό μ΄μ©ν• ν’€μ΄μ…λ‹λ‹¤. λ§μ€ λ¶„λ“¤μ΄ μ  λ¬Έμ μ—μ„ λ°”λ‚λ‚ μ°μ λ¥Ό μ±„κµ΄ν•΄ κ°€μ…¨κΈ° λ•λ¬Έμ—, μ„Έκ·Έλ¨ΌνΈ νΈλ¦¬μ— λ€ν• κ°„λµν• μ„¤λ…μ΄ ν•„μ”ν•λ‹¤κ³  μƒκ°ν•μ—¬ μ§§κ² μ„¤λ…μ„ λ“λ¦¬κ² μµλ‹λ‹¤.

> μ„Έκ·Έλ¨ΌνΈ νΈλ¦¬λ” μ–΄λ– ν• κµ¬κ°„μ μ—°μ‚°μ„ ν•λ” λ°μ— μ‚¬μ©λλ” νΈλ¦¬μ…λ‹λ‹¤. μ΄ μ—°μ‚°μ€ κµν™λ²•μΉ™κ³Ό κ²°ν•©λ²•μΉ™μ΄ μ„±λ¦½ν•λ‹¤λ©΄ μ–΄λ–¤ κ²ƒμ΄λ“  κ°€λ¥ν•©λ‹λ‹¤. μ‚¬μ©λλ” μ—°μ‚°μ μμ‹λ΅λ” μµλ“κ°’, μµμ†κ°’, κ³±μ…, λ§μ…, κ·Έλ¦¬κ³  λΉ„νΈ μ—°μ‚°μ΄ μμµλ‹λ‹¤.<br>κµ¬κ°„μ ν•©μ„ μ €μ¥ν•λ” μ„Έκ·Έλ¨ΌνΈ νΈλ¦¬ μμ‹λ¥Ό ν†µν•΄ μ„¤λ…μ„ λ“λ¦¬λ©΄, μ—¬λ¬λ¶„μ΄ 128κ°μ μ«μλ¥Ό μ…λ ¥μΌλ΅ λ°›λ”λ‹¤κ³  ν•©μ‹λ‹¤.<br>κ·Έλ¬λ©΄ μ΄ νΈλ¦¬μ μµμƒλ‹¨μ— μλ” λ£¨νΈ λ…Έλ“λ”, [1, 128]κΉμ§€μ ν•©μ„ μ €μ¥ν•©λ‹λ‹¤. λ£¨νΈ λ…Έλ“μ μμ‹μ€ μ„λ΅μ„λ΅ λ°μ”© λ²”μ„λ¥Ό μ–‘λ¶„ν•μ—¬, [1, 64], [65, 128]κΉμ§€μ ν•©μ„ λ‹΄λ‹Ήν•©λ‹λ‹¤. μ­‰ λ²”μ„λ¥Ό λ¶„μ μ‹ν‚¤λ‹¤λ³΄λ©΄ μ–Έμ  κ°€λ” μκΈ° μμ‹ μ κ°’λ§ μ €μ¥ν•λ” κ²½μ°κ°€ μƒκΉλ‹λ‹¤. [1, 1]μ²λΌ λ§μ΄μ£ . μ΄λ° μ‹μΌλ΅ λ²”μ„λ¥Ό "λ‚λ„λ©°" κµ¬κ°„μ λ€ν‘κ°’μ„ κ° λ…Έλ“λ“¤μ΄ μ €μ¥ν•κΈ° λ•λ¬Έμ— "Segment" treeλΌκ³  λ¶€λ¦…λ‹λ‹¤. μμ„Έν• μ„¤λ…μ„ ν•κΈ°μ—λ” μ£Όμ–΄μ§„ μΆ…μ΄κ°€ λ„λ¬΄ μ‘κΈ°μ—, μ΄ λ¬Έμ μ—μ„λ” μ΄ μ •λ„λ§ μ΄ν•΄ν•μ…”λ„ ν’€μ΄λ” λ³΄μ‹λ” λ°μ—λ” λ¬Έμ κ°€ μ—†μ„ κ²ƒμ΄λΌκ³  μƒκ°ν•©λ‹λ‹¤.

$\text{DP}[i] = \max_{j \gt i+k}^{n}\begin{cases}\text{DP}[j], & \text{if }p_i \ge p_j \\\ \text{DP}[j] + p_j -p_i, & \text{otherwise}\end{cases}$

μ½”λ“λ¥Ό λ³΄λ©΄μ„ ν’€μ΄λ¥Ό μ„¤λ…ν•΄ λ“λ¦¬κ² μµλ‹λ‹¤.

κ°κ° _sg1_, _sg2_ λ‘ κ°μ μ„Έκ·Έλ¨ΌνΈ νΈλ¦¬λ¥Ό μ¤€λΉ„ν•©λ‹λ‹¤. κ°κ°μ€ DPμ λ‘ μ΅°κ±΄μ— ν•΄λ‹Ήν•λ” μ •λ³΄λ¥Ό μ €μ¥ν•©λ‹λ‹¤.<br>μ΄ μ„Έκ·Έλ¨ΌνΈ νΈλ¦¬λ” λ¨λ‘ λ¦¬ν”„λ…Έλ“μ μΈλ±μ¤κ°€ κ°λ³„ μ μμ™€ κ°™μµλ‹λ‹¤. μ μμ λ²”μ„κ°€ $1 \le p \le 10^4$μ΄λ―€λ΅, 1λ¶€ν„° 10000μ μΈλ±μ¤λ¥Ό κ°™μ€ λ¦¬ν”„λ…Έλ“λ¥Ό λ‹΄λ” μ„Έκ·Έλ¨ΌνΈ νΈλ¦¬λ¥Ό λ§λ“­λ‹λ‹¤.<br>*sg1*μ—λ” ν•΄λ‹Ή μ μμ λ―Έν…μ΄ κ°€μ§ μ μλ” μµλ€μ μ μλ¥Ό λ„£κ³ , *sg2*μ—λ” κ·Έ μ μμ— μμ‹ μ μΈλ±μ¤(μ¦‰, λ―Έν…μ μ μ)λ§νΌμ„ λ”ν•΄λ‘μ—μµλ‹λ‹¤. μ„Έκ·Έλ¨ΌνΈ νΈλ¦¬μ κµ¬μ΅°μ²΄μ— κµ¬ν„λ _update_ ν•¨μλ” μ„Έκ·Έλ¨ΌνΈ νΈλ¦¬μ κµ¬κ°„λ“¤μ„ κ°±μ‹ ν•΄μ£Όλ” ν•¨μμ΄κ³ , *qupdate*λ” μ—¬κΈ°μ— Queueλ¥Ό λ”ν•΄ $k$λ² μ΄ν›„μ— μ΄ κ°’λ“¤μ΄ κ°±μ‹ λ  μ μλ„λ΅ ν•λ” ν•¨μμ…λ‹λ‹¤.

μ²« λ²μ§Έ λ―Έν…λ¶€ν„° μ‹μ‘ν•μ—¬ $k$λ² μ΄ν›„μ κ°’μ„ μ­‰ κ°±μ‹ ν•΄μ¤¬λ μ„λΈνƒμ¤ν¬ 2λ²μ ν’€μ΄μ™€ λ‹¬λ¦¬, λ§μ§€λ§‰ λ―Έν…λ¶€ν„° μ‹μ‘ν•©λ‹λ‹¤.<br>_λ§μ§€λ§‰ λ―Έν…λ¶€ν„° μ΄μ  λ³Έλ‹¤κ³  κ°€μ •ν•λ©΄_, $k$κ°λ” λ’¤μ— κ° μ μλ” λ―Έν…μ΄ μ—†μΌλ―€λ΅ *sg1*μ—λ” 0, *sg2*μ—λ” λ―Έν…μ μ μ(μ½”λ“μ—μ„λ” _current_)λ¥Ό μ €μ¥ν•΄μ£Όμ–΄μ•Ό ν•©λ‹λ‹¤. λ”°λΌμ„ *sg2*μ— *qupdate*λ¥Ό ν•λ” μ‹μΌλ΅ κµ¬ν„ν–μµλ‹λ‹¤.<br>μ΄μ  $k$κ°κ°€ μ§€λ‚λ©΄, μ§€κΈλ¶€ν„° λ³Ό λ―Έν…λ“¤μ€ λ’¤μ— κ° μ μλ” λ―Έν…μ΄ μκΈ° λ•λ¬Έμ—, μ΄ λ•κΉμ§€ μ΅°μ‚¬ν• λ―Έν… μ¤‘μ—μ„ μ μλ¥Ό μ–»μ–΄μ™€μ•Ό ν•©λ‹λ‹¤. DPμ‹μ„ λ³΄μ‹λ©΄ μ•„μ‹κ² μ§€λ§, μ΄λ” μ΄μ  λ³Ό λ―Έν… $i$μ μ μ, μ¦‰ $p_i$μ— μ „μ μΌλ΅ λ‹¬λ ¤μμµλ‹λ‹¤.<br>*sg1*μ—μ„λ” μμ‹ λ³΄λ‹¤ μ μκ°€ μ‘κ±°λ‚ κ°™μ€, $p_i$κΉμ§€μ μ μμ— ν•΄λ‹Ήν•λ” λ―Έν…λ“¤μ„ λ³΄κ³ , DP μ‹μ μ²« μ΅°κ±΄μΈ $\text{DP}[j]$λ¥Ό κµ¬ν•©λ‹λ‹¤.<br>*sg2*μ—μ„λ” μμ‹ λ³΄λ‹¤ μ μκ°€ λ†’μ€ λ―Έν…λ“¤μ„ λ³΄κ³ , λ‘ λ²μ§Έ μ΅°κ±΄μ $\text{DP}[j] + p_j$λ¥Ό κµ¬ν• λ’¤, *current*λ§νΌ μ΄λ¥Ό λΉΌμ¤λ‹λ‹¤.<br>μ΄ λ‘ μ(_fst_, _snd_) μ¤‘ μµλ“κ°’μ„ κµ¬ν• λ’¤, κ°κ°μ„ _sg1_, *sg2*μ μ΅°κ±΄μ— λ§κ² *qupdate*λ¥Ό ν•λ” κ³Όμ •μ„ λ°λ³µν•λ©΄μ„, κ·Έλ ‡κ² λ„μ¶λ μ μ μ¤‘μ—μ„ μµλ“κ°’μ„ μ¶λ ¥ν•λ” κ²ƒμΌλ΅ λ¬Έμ λ” λμ΄ λ‚©λ‹λ‹¤. μ΄ κ²½μ°μ μ‹κ°„λ³µμ΅λ„λ” $O(Nlog_2p_{max})$μ…λ‹λ‹¤.

## λ§μΉλ©°

---

μ²« λ€ν μ¶μ μ΄λ‹¤λ³΄λ‹, λ§μ€ λ¬Έμ λ“¤μ΄ μμ—μµλ‹λ‹¤. μ¶μ  μ•„μ΄λ””μ–΄λ¥Ό μ΅κΈ°λ„ νλ“¤μ—κ³ , λ‚μ΄λ„κ°€ μ μ ν• μ§€λ„ κ³„μ†ν•΄μ„ μλ¬Έμ΄ λ“¤μ—κ³ , λ‚΄λ¶€λ€νμΈλ° μ°Έκ°€μλ¶„λ“¤μ΄ λ§μ΅±ν•μ‹¤λ§ν• ν€„λ¦¬ν‹°λ¥Ό λ» λ‚΄λ©΄ μ–΄λ–΅ν•μ§€λΌλ” κ³ λ―Όλ„ μμ—μµλ‹λ‹¤. κ·Έλλ„ κ·Έλ‚λ§ λ§μ€ λ¶„λ“¤μ΄ νμκ°™μ€ μ €μ $k=0$ λ¶€λ¶„λ¬Έμ λ¥Ό λ„μ „ν•΄μ£Όμ…¨κΈ°λ„ ν•κ³ , λ°λ¬Έμ΄ μΆ€ μν•™κ°κ·Έλ‹¤λ³΄λ‹ μ¬λ°μ–΄ν•μ‹  κ²ƒ κ°™μ•„ μ²« λ¬Έμ μΉκ³ λ” μλ κ²ƒ κ°™κΈ°λ„ ν•©λ‹λ‹¤.

λ€ν μ¤‘μ—λ” ν…μ¤νΈ μΌ€μ΄μ¤κ°€ μ•½ν•΄μ„ μ κ°€ μ„¤λ…λ“λ¦° μµμ ν™”λ $O(N^2)$λ΅ μ„λΈνƒμ¤ν¬3κΉμ§€ λ«λ¦¬λ” λ¬Έμ λ„ μμ—κ³ , μλ»λ μ½”λ“λ¥Ό κ±°λ¥΄μ§€ λ»ν•κ³  λ§λ‹¤κ³  λ‚μ™€μ„ μ°Έκ°€μλ¶„κ»μ„ ν…μ¤νΈ μΌ€μ΄μ¤λ¥Ό μ¶”κ°€ν•΄μ£Όμ‹κΈ°λ„ ν–μµλ‹λ‹¤. (κ°μ‚¬λ“λ¦¬κ³  λ μ£„μ†΅ν•©λ‹λ‹¤ γ… γ… )

λ²μ¨ 2020λ…„λ„ 1μ›”μ λ§‰λ°”μ§€μ— λ‹¤λ‹¤λμµλ‹λ‹¤. μ‹ μΆ… μ½”λ΅λ‚ λ°”μ΄λ¬μ¤μ μ°½κ¶ μ†μ—μ„ λ°”λ‚λ‚ μ°μ λ¥Ό ν•λ‚μ”© λ“μ‹λ©° μ§‘μ—μ„ μ•„λ‘ν•κ² μ½”λ”©ν•μ‹κ³ , λ¶€λ”” κ±΄κ°• μ΅°μ‹¬ν•μ‹κΈΈ λ°”λλ‹λ‹¤. μ  λ¬Έμ  λ§μ΄ λ΄μ£Όμ…”μ„ κ°μ‚¬λ“λ¦¬κ³ , λ‹¤μμ—λ” λ°”λ‚λ‚ μ°μ μ™€ κ΄€λ ¨λ λ¬Έμ λ΅ μ°Ύμ•„λµ™κ² μµλ‹λ‹¤. λ‹¤μ‹ ν•λ² κ°μ‚¬λ“λ¦½λ‹λ‹¤ π
